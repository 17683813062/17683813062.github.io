var _=Object.defineProperty;var m=Object.getOwnPropertySymbols;var h=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var f=(t,o,e)=>o in t?_(t,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[o]=e,u=(t,o)=>{for(var e in o||(o={}))h.call(o,e)&&f(t,e,o[e]);if(m)for(var e of m(o))M.call(o,e)&&f(t,e,o[e]);return t};import{_ as j,r as O,l as A,A as v,o as y,t as L,c as $,u as k,f as S,p as x,n as I,b as P}from"./index.88915db1.js";import{s as N,j as W}from"./index.b41fe155.js";const z={beforeRouteEnter(t,o,e){e(i=>{i.store.commit("changeFooter",!1)})},setup(){const t=k();let o=O({store:t,localObj:{},user:JSON.parse(localStorage.getItem("user")),peopleList:[]}),e=null,i=null;A(()=>{v(()=>{g()})});const g=()=>{e=new AMap.Map("mapContainer",{zoom:12,pitch:45,viewMode:"3D"}),i=new AMap.Marker({position:new AMap.LngLat(116.401337,39.907886),title:"\u5317\u4EAC",offset:new AMap.Pixel(-8,-3)});let a=["<h6 style='font-size:0.34rem;padding:0;margin:0;line-height:0.8rem;margin-top:0.5rem'>\u672A\u53D1\u8D27\u5371\u5E9F\u95F4</h6>","<p style='padding:0;margin:0;'>222</p>",'<button onclick="goGDmap(116.401337, 39.907886})" >\u5BFC\u822A</button>'],n=new AMap.InfoWindow({content:a.join("")});d(),n.open(e,[116.401337,39.907886]),i.on("click",()=>{n.open(e,[116.401337,39.907886])}),e.add(i)},d=()=>{AMap.plugin("AMap.Geolocation",function(){var a=new AMap.Geolocation({enableHighAccuracy:!0,timeout:1e4,offset:[10,20],zoomToAccuracy:!0,position:"RB"});a.getCurrentPosition(function(l,r){l=="complete"?n(r):s(r)});function n(l){o.localObj.lng=l.position.lng,o.localObj.lat=l.position.lat,o.localObj.address=l.formattedAddress,console.log(JSON.stringify(o.localObj)),w(l),b(),i=new AMap.Marker({position:new AMap.LngLat(o.localObj.lng,o.localObj.lat),title:"\u6211\u7684",offset:new AMap.Pixel(-8,-3)});let r=[`<h6 style='font-size:0.3rem;padding:0;margin:0;line-height:0.5rem;margin-top:0.8rem'>${o.localObj.address}</h6>`,"<p style='padding:0;margin:0;'>\u60A8\u5F53\u524D\u4F4D\u7F6E</p>"],c=new AMap.InfoWindow({content:r.join("")});i.on("click",()=>{c.open(e,[o.localObj.lng,o.localObj.lat])}),c.open(e,[o.localObj.lng,o.localObj.lat]),e.add(i),e.setCenter(new AMap.LngLat(o.localObj.lng,o.localObj.lat))}function s(l){console.log(l,"\u5B9A\u4F4D\u51FA\u9519")}})},w=async a=>{let n={lng:a.position.lng,lat:a.position.lat,address:a.formattedAddress,user:o.user};console.log(JSON.stringify(n)),console.log("\u4FDD\u5B58\u7528\u6237\u4FE1\u606F1");let s=await N(n);console.log(JSON.stringify(s),"\u4FDD\u5B58\u7528\u6237\u4FE1\u606F2")},b=async()=>{let a=await W({user:o.user});o.peopleList=a.result,alert(JSON.stringify(o.peopleList)),o.peopleList.forEach(n=>{let s=new AMap.Marker({position:new AMap.LngLat(n.lng,n.lat),title:n.username,offset:new AMap.Pixel(-8,-3)}),l=[`<h6 style='font-size:0.34rem;padding:0;margin:0;line-height:0.5rem;margin-top:0.5rem'>${n.username}</h6>`,`<p style='padding:0;margin:0;line-height:0.6rem;margin-top:0.2rem'>${n.address}</p>`,`<button onclick="goGDmap(${n.lng+","+n.lat})" >\u5BFC\u822A</button>`],r=new AMap.InfoWindow({content:l.join("")});s.on("click",()=>{r.open(e,[n.lng,n.lat])}),window.goGDmap=function(c,p){alert(c+";"+p+`;https://uri.amap.com/navigation?from=${o.localObj.lng},${o.localObj.lat}&to=${c},${p}&mode=walk&callnative=1&coordinate=wgs84&src=mypage`),setTimeout(()=>{window.location.href=`https://uri.amap.com/navigation?from=${o.localObj.lng},${o.localObj.lat}&to=${c},${p}&mode=walk&callnative=1&coordinate=wgs84&src=mypage`},1e3)},e.add(s)}),console.log(a,"\u4EBA\u5458\u5B9A\u4F4D\u4FE1\u606F",o.peopleList)};return y((a,n)=>{t.commit("changeFooter",!0)}),u({},L(o))}},B=t=>(x("data-v-723c0bfb"),t=t(),I(),t),C={class:"main"},G=B(()=>P("div",{class:"map",id:"mapContainer"},null,-1)),J=[G];function D(t,o,e,i,g,d){return S(),$("div",C,J)}var F=j(z,[["render",D],["__scopeId","data-v-723c0bfb"]]);export{F as default};
