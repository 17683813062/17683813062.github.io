var _=Object.defineProperty;var d=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable;var m=(t,e,o)=>e in t?_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,f=(t,e)=>{for(var o in e||(e={}))M.call(e,o)&&m(t,o,e[o]);if(d)for(var o of d(e))h.call(e,o)&&m(t,o,e[o]);return t};import{_ as b,r as A,l as j,A as O,o as v,t as y,c as L,u as k,f as $,p as S,n as x,b as I}from"./index.0cb32dbb.js";import{s as P,j as W}from"./index.b41fe155.js";const z={beforeRouteEnter(t,e,o){o(a=>{a.store.commit("changeFooter",!1)})},setup(){const t=k();let e=A({store:t,localObj:{},user:JSON.parse(localStorage.getItem("user")),peopleList:[]}),o=null,a=null;j(()=>{O(()=>{c()})});const c=()=>{o=new AMap.Map("mapContainer",{zoom:12,pitch:45,viewMode:"3D"}),a=new AMap.Marker({position:new AMap.LngLat(116.401337,39.907886),title:"\u5317\u4EAC",offset:new AMap.Pixel(-8,-3)});let l=["<h6 style='font-size:0.34rem;padding:0;margin:0;line-height:0.8rem;margin-top:0.5rem'>\u672A\u53D1\u8D27\u5371\u5E9F\u95F4</h6>","<p style='padding:0;margin:0;'>222</p>","<button>\u5BFC\u822A</button>"],n=new AMap.InfoWindow({content:l.join("")});g(),w(),n.open(o,[116.401337,39.907886]),a.on("click",()=>{n.open(o,[116.401337,39.907886])}),o.add(a)},g=()=>{AMap.plugin("AMap.Geolocation",function(){var l=new AMap.Geolocation({enableHighAccuracy:!0,timeout:1e4,offset:[10,20],zoomToAccuracy:!0,position:"RB"});l.getCurrentPosition(function(s,i){s=="complete"?n(i):r(i)});function n(s){e.localObj.lng=s.position.lng,e.localObj.lat=s.position.lat,e.localObj.address=s.formattedAddress,console.log(JSON.stringify(e.localObj)),u(s),a=new AMap.Marker({position:new AMap.LngLat(e.localObj.lng,e.localObj.lat),title:"\u6211\u7684",offset:new AMap.Pixel(-8,-3)});let i=[`<h6 style='font-size:0.3rem;padding:0;margin:0;line-height:0.5rem;margin-top:0.8rem'>${e.localObj.address}</h6>`,"<p style='padding:0;margin:0;'>\u60A8\u5F53\u524D\u4F4D\u7F6E</p>"],p=new AMap.InfoWindow({content:i.join("")});a.on("click",()=>{p.open(o,[e.localObj.lng,e.localObj.lat])}),p.open(o,[e.localObj.lng,e.localObj.lat]),o.add(a),o.setCenter(new AMap.LngLat(e.localObj.lng,e.localObj.lat))}function r(s){console.log(s,"\u5B9A\u4F4D\u51FA\u9519")}})},u=async l=>{let n={lng:l.position.lng,lat:l.position.lat,address:l.formattedAddress,user:e.user};console.log(JSON.stringify(n)),console.log("\u4FDD\u5B58\u7528\u6237\u4FE1\u606F1");let r=await P(n);console.log(JSON.stringify(r),"\u4FDD\u5B58\u7528\u6237\u4FE1\u606F2")},w=async()=>{let l=await W({user:e.user});e.peopleList=l.result,e.peopleList.forEach(n=>{a=new AMap.Marker({position:new AMap.LngLat(n.lng,n.lat),title:n.username,offset:new AMap.Pixel(-8,-3)});let r=[`<h6 style='font-size:0.34rem;padding:0;margin:0;line-height:0.5rem;margin-top:0.5rem'>${n.username}</h6>`,`<p style='padding:0;margin:0;line-height:0.6rem;margin-top:0.2rem'>${n.address}</p>`,`<button onclick="goGDmap(${n.lng+","+n.lat})" >\u5BFC\u822A</button>`],s=new AMap.InfoWindow({content:r.join("")});a.on("click",()=>{s.open(o,[n.lng,n.lat])}),window.goGDmap=function(i,p){window.location.href=`androidamap://navi?sourceApplication=appname&amp;poiname=fangheng&amp;lat=${p}&amp;lon=${i}&amp;dev=1&amp;style=2`,console.log(i,p)},o.add(a)}),console.log(l,"\u4EBA\u5458\u5B9A\u4F4D\u4FE1\u606F",e.peopleList)};return v((l,n)=>{t.commit("changeFooter",!0)}),f({},y(e))}},B=t=>(S("data-v-8db594ca"),t=t(),x(),t),C={class:"main"},N=B(()=>I("div",{class:"map",id:"mapContainer"},null,-1)),E=[N];function G(t,e,o,a,c,g){return $(),L("div",C,E)}var F=b(z,[["render",G],["__scopeId","data-v-8db594ca"]]);export{F as default};
