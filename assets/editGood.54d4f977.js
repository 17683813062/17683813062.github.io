var E=Object.defineProperty,F=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var V=(o,a,l)=>a in o?E(o,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):o[a]=l,x=(o,a)=>{for(var l in a||(a={}))B.call(a,l)&&V(o,l,a[l]);if(C)for(var l of C(a))D.call(a,l)&&V(o,l,a[l]);return o},L=(o,a)=>F(o,G(a));import{_ as M,r as S,B as U,o as N,b as H,t as I,a as v,c as g,d as r,w as d,e as u,F as O,m as P,x as z,f as $,u as j,g as q,M as y,h as m,y as J,z as T,i as c}from"./index.aa338e25.js";import{j as A,k as K,m as Q,n as W}from"./index.1fb92cbc.js";import{w as X}from"./wangEditor.e57115ba.js";const Y={beforeRouteEnter(o,a,l){l(e=>{e.store.commit("changeFooter",!1)})},setup(){const o=$(),a=j(),l=q();let e=S({store:o,serverUrl:U,_id:"",title:"",desc:"",price:null,html:"",fileList1:[],editor:null,editorMaxHeight:null,editorContent:""}),b=()=>{l.push({path:"/getOnlinePath"})},w=async()=>{let t={_id:e._id,html:e.editor.txt.html()};(await A(t)).code==1&&y.success("\u5BCC\u6587\u672C\u7F16\u8F91\u6210\u529F")},_=async()=>{let t={_id:e._id,title:e.title,desc:e.desc,price:Number(e.price),bannerList:e.fileList1};(await K(t)).code==1&&y.success("\u7F16\u8F91\u5546\u54C1\u6210\u529F")},s=t=>{e.fileList1.splice(t,1)},f=t=>{console.log(t),t.length||(t=[t]);var i=new FormData;i.enctype="multipart/form-data",t.forEach(function(p){i.append("myfile",p.file)}),Q(i).then(p=>{let k=e.fileList1;p.fileList.forEach(R=>{k.push({url:e.serverUrl+R.filename})}),e.fileList1=k,y.success("\u4E0A\u4F20\u56FE\u7247\u6210\u529F")})},n=()=>{e.editorMaxHeight=window.innerHeight-300,e.editor=new X("#toolbar-container","#text-container"),e.editor.config.onchange=function(t){e.editorContent=t},e.editor.create()},h=async()=>{let t=await W({_id:e._id});e.title=t.result[0].title,e.desc=t.result[0].desc,e.price=t.result[0].price,e.html=t.result[0].html,e.fileList1=JSON.parse(t.result[0].bannerList),e.editor.txt.html(e.html)};return N(()=>{e._id=a.query._id,h(),n()}),H((t,i)=>{o.commit("changeFooter",!0)}),L(x({},I(e)),{getOnlinePath:b,editGood:_,afterRead:f,removeFileList:s,editEditorData:w})}},Z=o=>(J("data-v-f944c6ec"),o=o(),T(),o),ee=m(" \u7F16\u8F91\u5546\u54C1 "),te={class:"fileList"},oe=["onClick"],ae=m("\u7F16\u8F91\u5546\u54C1"),le=m("\u7F16\u8F91\u5BCC\u6587\u672C"),ie=m("\u4E0A\u4F20\u5BCC\u6587\u672C"),re=m("\u83B7\u53D6\u56FE\u7247\u5728\u7EBF\u94FE\u63A5"),se=Z(()=>u("div",{id:"toolbar-container",class:"toolbar"},null,-1));function ne(o,a,l,e,b,w){const _=c("t-navbar"),s=c("van-field"),f=c("van-uploader"),n=c("t-button"),h=c("t-divider");return v(),g("div",null,[r(_,{onClickRight:o.submit},{default:d(()=>[ee]),_:1},8,["onClickRight"]),r(s,{modelValue:o.title,"onUpdate:modelValue":a[0]||(a[0]=t=>o.title=t),rows:"1",autosize:"",label:"\u5546\u54C1\u540D\u79F0",type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0"},null,8,["modelValue"]),r(s,{modelValue:o.desc,"onUpdate:modelValue":a[1]||(a[1]=t=>o.desc=t),rows:"1",autosize:"",label:"\u5546\u54C1\u7B80\u4ECB",type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u7B80\u4ECB"},null,8,["modelValue"]),r(s,{modelValue:o.price,"onUpdate:modelValue":a[2]||(a[2]=t=>o.price=t),rows:"1",autosize:"",label:"\u5546\u54C1\u4EF7\u683C",type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u4EF7\u683C"},null,8,["modelValue"]),u("ul",te,[(v(!0),g(O,null,P(o.fileList1,(t,i)=>(v(),g("li",{onClick:p=>e.removeFileList(i),key:i},[u("div",{style:z("background: url("+t.url+") top center no-repeat;background-size: cover;"),class:"imgBox"},null,4)],8,oe))),128))]),r(f,{multiple:"","after-read":e.afterRead},null,8,["after-read"]),r(n,{onClick:a[3]||(a[3]=t=>e.editGood()),theme:"primary",size:"large"},{default:d(()=>[ae]),_:1}),u("div",null,[r(h,null,{default:d(()=>[le]),_:1}),r(n,{onClick:a[4]||(a[4]=t=>e.editEditorData()),theme:"primary",size:"small"},{default:d(()=>[ie]),_:1}),r(n,{onClick:e.getOnlinePath,style:{"margin-left":"0.2rem"},theme:"primary",size:"small"},{default:d(()=>[re]),_:1},8,["onClick"]),se,u("div",{id:"text-container",style:z("max-height:"+o.editorMaxHeight+"px"),class:"text"},null,4)])])}var pe=M(Y,[["render",ne],["__scopeId","data-v-f944c6ec"]]);export{pe as default};
