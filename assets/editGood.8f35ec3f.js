var z=Object.defineProperty,F=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var C=(o,a,l)=>a in o?z(o,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):o[a]=l,L=(o,a)=>{for(var l in a||(a={}))D.call(a,l)&&C(o,l,a[l]);if(x)for(var l of x(a))M.call(a,l)&&C(o,l,a[l]);return o},R=(o,a)=>F(o,G(a));import{_ as S,r as B,l as U,o as H,t as I,c as v,a as s,w as n,b as c,F as N,m as O,s as V,u as P,v as $,d as q,x as J,M as g,p as T,n as j,e as d,f as b,g as u}from"./index.78561dea.js";import{e as A,c as K,u as Q,d as W}from"./index.802ab18f.js";import{w as X}from"./wangEditor.0fdbc078.js";const Y={beforeRouteEnter(o,a,l){l(e=>{e.store.commit("changeFooter",!1)})},setup(){const o=P(),a=$(),l=q();let e=B({store:o,serverUrl:J,_id:"",title:"",desc:"",html:"",fileList1:[],editor:null,editorMaxHeight:null,editorContent:""}),y=()=>{l.push({path:"/getOnlinePath"})},w=async()=>{let t={_id:e._id,html:e.editor.txt.html()};(await A(t)).code==1&&g.success("\u5BCC\u6587\u672C\u7F16\u8F91\u6210\u529F")},p=async()=>{let t={_id:e._id,title:e.title,desc:e.desc,bannerList:e.fileList1};(await K(t)).code==1&&g.success("\u7F16\u8F91\u5546\u54C1\u6210\u529F")},m=t=>{e.fileList1.splice(t,1)},f=t=>{console.log(t),t.length||(t=[t]);var i=new FormData;i.enctype="multipart/form-data",t.forEach(function(_){i.append("myfile",_.file)}),Q(i).then(_=>{let k=e.fileList1;_.fileList.forEach(E=>{k.push({url:e.serverUrl+E.filename})}),e.fileList1=k,g.success("\u4E0A\u4F20\u56FE\u7247\u6210\u529F")})},r=()=>{e.editorMaxHeight=window.innerHeight-300,e.editor=new X("#toolbar-container","#text-container"),e.editor.config.onchange=function(t){e.editorContent=t},e.editor.create()},h=async()=>{let t=await W({_id:e._id});e.title=t.result[0].title,e.desc=t.result[0].desc,e.html=t.result[0].html,e.fileList1=JSON.parse(t.result[0].bannerList),e.editor.txt.html(e.html)};return U(()=>{e._id=a.query._id,h(),r()}),H((t,i)=>{o.commit("changeFooter",!0)}),R(L({},I(e)),{getOnlinePath:y,editGood:p,afterRead:f,removeFileList:m,editEditorData:w})}},Z=o=>(T("data-v-6c6bb2f4"),o=o(),j(),o),ee=u(" \u7F16\u8F91\u5546\u54C1 "),te={class:"fileList"},oe=["onClick"],ae=u("\u7F16\u8F91\u5546\u54C1"),le=u("\u7F16\u8F91\u5BCC\u6587\u672C"),ie=u("\u4E0A\u4F20\u5BCC\u6587\u672C"),se=u("\u83B7\u53D6\u56FE\u7247\u5728\u7EBF\u94FE\u63A5"),re=Z(()=>c("div",{id:"toolbar-container",class:"toolbar"},null,-1));function ne(o,a,l,e,y,w){const p=d("t-navbar"),m=d("van-field"),f=d("van-uploader"),r=d("t-button"),h=d("t-divider");return b(),v("div",null,[s(p,{onClickRight:o.submit},{default:n(()=>[ee]),_:1},8,["onClickRight"]),s(m,{modelValue:o.title,"onUpdate:modelValue":a[0]||(a[0]=t=>o.title=t),rows:"1",autosize:"",label:"\u5546\u54C1\u540D\u79F0",type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0"},null,8,["modelValue"]),s(m,{modelValue:o.desc,"onUpdate:modelValue":a[1]||(a[1]=t=>o.desc=t),rows:"1",autosize:"",label:"\u5546\u54C1\u7B80\u4ECB",type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u7B80\u4ECB"},null,8,["modelValue"]),c("ul",te,[(b(!0),v(N,null,O(o.fileList1,(t,i)=>(b(),v("li",{onClick:_=>e.removeFileList(i),key:i},[c("div",{style:V("background: url("+t.url+") top center no-repeat;background-size: cover;"),class:"imgBox"},null,4)],8,oe))),128))]),s(f,{multiple:"","after-read":e.afterRead},null,8,["after-read"]),s(r,{onClick:a[2]||(a[2]=t=>e.editGood()),theme:"primary",size:"large"},{default:n(()=>[ae]),_:1}),c("div",null,[s(h,null,{default:n(()=>[le]),_:1}),s(r,{onClick:a[3]||(a[3]=t=>e.editEditorData()),theme:"primary",size:"small"},{default:n(()=>[ie]),_:1}),s(r,{onClick:e.getOnlinePath,style:{"margin-left":"0.2rem"},theme:"primary",size:"small"},{default:n(()=>[se]),_:1},8,["onClick"]),re,c("div",{id:"text-container",style:V("max-height:"+o.editorMaxHeight+"px"),class:"text"},null,4)])])}var _e=S(Y,[["render",ne],["__scopeId","data-v-6c6bb2f4"]]);export{_e as default};
