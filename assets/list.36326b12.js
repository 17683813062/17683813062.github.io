var V=Object.defineProperty,A=Object.defineProperties;var F=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var D=(e,t,n)=>t in e?V(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,I=(e,t)=>{for(var n in t||(t={}))W.call(t,n)&&D(e,n,t[n]);if(b)for(var n of b(t))z.call(t,n)&&D(e,n,t[n]);return e},C=(e,t)=>A(e,F(t));import{_ as J,d as O,U as y,r as Y,o as E,t as j,a as w,c as N,f as m,w as v,g as l,n as i,C as R,F as q,z as G,B as H,aa as K,v as P,x as Q,j as p}from"./index.ee240181.js";import{b as T}from"./utils.95e6bb58.js";const X={setup(){const e=O(),t=y([]),n=y(!1),s=y(!1),u=y(!1);let o=Y({user:JSON.parse(localStorage.getItem("user")),page:0,limit:10,totle:"",getToday1:T(),myList:[]}),c=(r,g)=>{r=new Date(r.replace(/-/g,"/")),g=new Date(g.replace(/-/g,"/"));var h=Math.abs(r.getTime()-g.getTime())/1e3/24/60/60,k=Math.floor(h/365);return k},f=r=>{e.push({path:"/nearDetail",query:{username:r}})};const L=()=>{console.log("\u52A0\u8F7D+1"),o.page+=1,a()},_=()=>{s.value=!1,n.value=!0,a()};let a=async()=>{let{page:r,limit:g}=o;u.value&&(u.value=!1);let h=await K({page:r,limit:g});t.value=[];let k=t.value,U=h.reult.filter(d=>d.username!==o.user.username);o.myList=h.reult.filter(d=>d.username==o.user.username);let S=k.concat(U);S.forEach((d,ie)=>{var B=AMap.GeometryUtil.distance([o.myList[0].lng,o.myList[0].lat],[d.lng,d.lat]);let M=Number(B)/1e3;d.distance=M.toFixed(2)}),t.value=S,n.value=!1,(h.reult.length==0||h.reult.length<o.limit)&&(s.value=!0),console.log(t,"\u6240\u6709\u4EBA\u5458")};return E(()=>{}),C(I({list:t,onLoad:L,loading:n,finished:s,onRefresh:_,refreshing:u},j(o)),{goDetail:f,getYear:c,getToday1:T})}},Z=e=>(P("data-v-6b77f2a8"),e=e(),Q(),e),$={class:"near"},x={class:"right"},ee={style:{"font-weight":"200","font-size":"0.3rem"}},te=Z(()=>l("span",null,"0.00km",-1)),ae=["onClick"],se={class:"right"},ne={style:{"font-weight":"200","font-size":"0.3rem"}};function le(e,t,n,s,u,o){const c=p("van-image"),f=p("van-cell"),L=p("van-list"),_=p("van-pull-refresh");return w(),N("div",$,[m(_,{modelValue:s.refreshing,"onUpdate:modelValue":t[2]||(t[2]=a=>s.refreshing=a),onRefresh:s.onRefresh},{default:v(()=>[m(L,{loading:s.loading,"onUpdate:loading":t[1]||(t[1]=a=>s.loading=a),finished:s.finished,"finished-text":"\u6CA1\u6709\u66F4\u591A\u4E86",onLoad:s.onLoad},{default:v(()=>[m(f,{center:""},{title:v(()=>[l("div",{onClick:t[0]||(t[0]=R(a=>s.goDetail(e.myList[0]?e.myList[0].username:""),["stop"])),class:"main"},[m(c,{width:"100",height:"100",src:e.myList[0]?JSON.parse(e.myList[0].user).headImg:""},null,8,["src"]),l("div",x,[l("h6",null,i(e.myList[0]?e.myList[0].nickname?e.myList[0].nickname:e.myList[0].username:""),1),l("h6",ee,i(e.myList[0]?e.myList[0].birthday?s.getYear(e.myList[0].birthday,s.getToday1()):"\u6682\u65E0":"")+" \xA0"+i(e.myList[0]?e.myList[0].heightWeight?e.myList[0].heightWeight:"\u6682\u65E0":"")+"\xA0 "+i(e.myList[0]?e.myList[0].attr?e.myList[0].attr:"\u6682\u65E0":""),1),l("p",null,i(e.myList[0]?e.myList[0].sign?e.myList[0].sign:"\u6682\u65E0\u7B7E\u540D":""),1),te])])]),_:1}),(w(!0),N(q,null,G(s.list,(a,r)=>(w(),H(f,{center:"",key:r},{title:v(()=>[l("div",{onClick:R(g=>s.goDetail(a.username),["stop"]),class:"main"},[m(c,{width:"100",height:"100",src:JSON.parse(a.user).headImg},null,8,["src"]),l("div",se,[l("h6",null,i(a.nickname?a.nickname:a.username),1),l("h6",ne,i(a.birthday?s.getYear(a.birthday,s.getToday1()):"\u6682\u65E0")+" \xA0"+i(a.heightWeight?a.heightWeight:"\u6682\u65E0")+"\xA0 "+i(a.attr?a.attr:"\u6682\u65E0"),1),l("p",null,i(a.sign?a.sign:"\u6682\u65E0\u7B7E\u540D"),1),l("span",null,i(a.distance)+"km",1)])],8,ae)]),_:2},1024))),128))]),_:1},8,["loading","finished","onLoad"])]),_:1},8,["modelValue","onRefresh"])])}var ge=J(X,[["render",le],["__scopeId","data-v-6b77f2a8"]]);export{ge as default};
